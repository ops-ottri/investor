<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/>
<title>Ottri Investor Update — Confidential</title>
<meta name="robots" content="noindex,nofollow"/>
<style>
:root{
  --bg:#0a0a12;--panel:#141425;--ink:#eae9ff;--muted:#9ca3af;--accent:#a78bfa;--danger:#f87171;
  --radius:16px;--chev-size:22px
}
html,body{height:100%;margin:0}
body{background:radial-gradient(1000px 600px at 50% -10%,#1f1b39 0%,#0a0a12 60%,#0a0a12 100%);
color:var(--ink);font:500 15px/1.6 "Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial}
.center{min-height:100%;display:grid;place-items:center;padding:40px}
.card{width:min(460px,92vw);background:var(--panel);border-radius:var(--radius);padding:26px;
box-shadow:0 18px 40px rgba(0,0,0,.5),inset 0 1px 0 rgba(255,255,255,.04);
animation:fadeIn .4s ease}
@keyframes fadeIn{from{opacity:0;transform:scale(.96)}to{opacity:1;transform:scale(1)}}
h1{margin:0 0 10px;font-weight:800;font-size:22px;text-align:center}
.subtitle{color:var(--muted);text-align:center;margin-bottom:18px}
.row{display:flex;gap:10px}
input[type=password]{flex:1;background:#0f1020;border:1px solid #2a2a44;border-radius:10px;
padding:13px 14px;color:var(--ink);font-weight:600;letter-spacing:.2em}
button{background:linear-gradient(145deg,#7c66f2,#a78bfa);border:none;border-radius:10px;
padding:0 16px;color:white;font-weight:700;cursor:pointer;min-height:44px}
.hint{margin-top:8px;height:18px;color:var(--muted);font-size:13px;text-align:center;transition:opacity .25s}
.hint.error{color:var(--danger)}
#app{display:none;opacity:0;transition:opacity .5s}
@media print{body{display:none!important}}
main{max-width:1080px;margin:40px auto;padding:0 20px}
section{margin:20px 0;background:#141425;border-radius:var(--radius);overflow:hidden;
transition:max-height .4s ease,padding .3s ease}
section header{padding:18px;display:flex;align-items:center;justify-content:space-between;
cursor:pointer;user-select:none}
section h3{margin:0;font-size:18px;font-weight:700}
section ul{margin:0;padding:0 20px 18px 38px;list-style:disc;color:var(--muted)}
section.closed ul{display:none}
.chev{width:var(--chev-size);height:var(--chev-size);position:relative;transition:transform .3s ease}
.chev::before,.chev::after{
  content:"";position:absolute;width:10px;height:2px;background:var(--accent);
  top:10px;left:6px;border-radius:2px;animation:pulse 1.5s infinite ease-in-out;
}
.chev::before{transform:rotate(45deg)}
.chev::after{transform:rotate(-45deg)}
@keyframes pulse{0%,100%{opacity:.3;transform:scale(1)}50%{opacity:1;transform:scale(1.2)}}
section.open .chev{transform:rotate(180deg)}
h2{margin:0 0 6px;font-size:28px;font-weight:900}
p{margin:6px 0;color:var(--ink)}
</style>
</head>
<body>

<!-- Password Gate -->
<div id="gate" class="center">
  <div class="card">
    <h1>Confidential Access</h1>
    <div class="subtitle">Enter your password to view this update.</div>
    <div class="row" style="margin:12px 0 4px">
      <input id="pw" type="password" placeholder="••••••••"/>
      <button id="go">Unlock</button>
    </div>
    <div id="msg" class="hint" aria-live="polite"></div>
    <div class="hint">Do not share, print, or capture this page.</div>
  </div>
</div>

<!-- App -->
<div id="app">
  <main>
    <header style="display:flex;align-items:center;justify-content:space-between;margin-bottom:28px">
      <h2>Ottri — Investor Update</h2>
      <span style="color:var(--muted)">Confidential</span>
    </header>
    <div id="content"><p style="color:var(--muted)">Loading…</p></div>
  </main>
</div>

<script>
/******** CONFIG ********/
const SHEET_ID = "13qIOuAUWe9sOrytSm3j6s1tsuRASZNL2MEpcZsyBYUc";
const TABS = ["title","intro","team","momentum","product","roadmap","market","partners","vision","footer"];
const STATIC_PASSWORD_SHA256 = "9cc166b8de422e9f8f1778a93c6e3f67a19c2838f15230f492a7f60d7ee5f9e8"; // "iloveottri"

/******** UTIL ********/
async function sha256Hex(txt){
  const buf=new TextEncoder().encode(txt);
  const hash=await crypto.subtle.digest("SHA-256",buf);
  return Array.from(new Uint8Array(hash)).map(b=>b.toString(16).padStart(2,"0")).join("");
}
function gvizUrl(tab){return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(tab)}&range=A:Z`;}
function parseGViz(raw){const s=raw.indexOf("{"),e=raw.lastIndexOf("}");if(s<0||e<0)return[];const json=JSON.parse(raw.slice(s,e+1));return(json.table?.rows||[]).map(r=>(r.c||[]).map(c=>(c?.v??"").toString()));}
async function fetchTab(t){try{const r=await fetch(gvizUrl(t),{cache:"no-store"});if(!r.ok)return[];return parseGViz(await r.text());}catch{return[]}}
async function loadAll(){const data={};await Promise.all(TABS.map(async t=>data[t]=await fetchTab(t)));return data;}
const cell=(sh,r=1,c=1)=>(sh?.[r-1]?.[c-1]??"").toString();
const rows=sh=>Array.isArray(sh)?sh:[];

/******** RENDER ********/
function render(payload){
  const el=document.getElementById("content");
  let html="";
  const title=cell(payload.title,1,1);
  const intro=cell(payload.intro,1,1);
  if(title)html+=`<section class="open"><header><h3>${title}</h3><div class="chev"></div></header><ul><li>${intro||""}</li></ul></section>`;
  const sections=["team","momentum","product","roadmap","market","partners","vision","footer"];
  sections.forEach(name=>{
    const tab=rows(payload[name]);
    const items=tab.map(r=>r[0]).filter(Boolean).map(v=>`<li>${v}</li>`).join("");
    if(items)html+=`<section class="closed"><header><h3>${name[0].toUpperCase()+name.slice(1)}</h3><div class="chev"></div></header><ul>${items}</ul></section>`;
  });
  el.innerHTML=html||"<p style='color:var(--muted)'>Sheet loaded but empty.</p>";

  // Accordion behavior
  el.querySelectorAll("section header").forEach(h=>{
    h.addEventListener("click",()=>{
      const sec=h.parentElement;
      const open=sec.classList.toggle("open");
      sec.classList.toggle("closed",!open);
    });
  });
}

/******** MAIN ********/
let SHEET_DATA={};
async function unlock(){
  const pw=document.getElementById("pw").value.trim();
  const msg=document.getElementById("msg");
  const hash=(await sha256Hex(pw)).toLowerCase();
  if(hash!==STATIC_PASSWORD_SHA256){
    msg.textContent="Invalid password";
    msg.classList.add("error");
    return;
  }
  msg.textContent="";
  document.getElementById("gate").style.display="none";
  const app=document.getElementById("app");
  app.style.display="block";
  requestAnimationFrame(()=>app.style.opacity=1);
  render(SHEET_DATA);
}

document.addEventListener("DOMContentLoaded",async()=>{
  try{SHEET_DATA=await loadAll();}catch(e){console.warn("Sheet load failed",e);}
  document.getElementById("go").addEventListener("click",unlock);
  document.getElementById("pw").addEventListener("keydown",e=>{if(e.key==="Enter")unlock();});
  // Disable print/copy
  window.addEventListener("keydown",e=>{const p=(e.ctrlKey||e.metaKey)&&["p","s","c"].includes(e.key.toLowerCase());if(p){e.preventDefault();}},true);
  document.addEventListener("contextmenu",e=>e.preventDefault(),true);
  document.addEventListener("copy",e=>e.preventDefault(),true);
});
</script>
</body>
</html>
